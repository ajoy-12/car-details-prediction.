# -*- coding: utf-8 -*-
"""Car information dataset

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Vctbpv-ka7s3dmI0Syc1purkJDwGg_qf
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

car = pd.read_csv('/content/Automobile.csv')

car.head(5)

car.info()

car.isnull().sum()

car.duplicated().sum()

car.describe()

sns.heatmap(car.corr(numeric_only=True), annot=True, cmap='plasma')

from sklearn.preprocessing import StandardScaler

# Initialize the StandardScaler
scaler = StandardScaler()

# Fit the scaler on the training data and transform both training and test data
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

print("Features scaled successfully!")
print(f"Shape of scaled X_train: {X_train_scaled.shape}")
print(f"Shape of scaled X_test: {X_test_scaled.shape}")

car['horsepower'] = car['horsepower'].fillna(car['horsepower'].mean())
print(car.isnull().sum())

"""Now, let's evaluate the performance of our Linear Regression model using several common metrics."""

from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score
import numpy as np

# Calculate evaluation metrics
mae = mean_absolute_error(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
r2 = r2_score(y_test, y_pred)

print(f"Mean Absolute Error (MAE): {mae:.3f}")
print(f"Mean Squared Error (MSE): {mse:.3f}")
print(f"Root Mean Squared Error (RMSE): {rmse:.3f}")
print(f"R-squared (R2): {r2:.3f}")

from sklearn.linear_model import LinearRegression

# Initialize the Linear Regression model
model = LinearRegression()

# Train the model using the training data
model.fit(X_train, y_train)

print("Linear Regression model trained successfully!")

print("Train R2:", model.score(X_train, y_train))
print("Test R2:", model.score(X_test, y_test))

from sklearn.linear_model import LinearRegression

# Initialize the Linear Regression model
scaled_model = LinearRegression()

# Train the model using the scaled training data
scaled_model.fit(X_train_scaled, y_train)

print("Linear Regression model trained successfully with scaled data!")

y_pred_scaled = scaled_model.predict(X_test_scaled)
print("Predictions on scaled test data generated successfully!")

from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score
import numpy as np

# Calculate evaluation metrics for the scaled model
mae_scaled = mean_absolute_error(y_test, y_pred_scaled)
mse_scaled = mean_squared_error(y_test, y_pred_scaled)
rmse_scaled = np.sqrt(mse_scaled)
r2_scaled = r2_score(y_test, y_pred_scaled)

print(f"Scaled Model - Mean Absolute Error (MAE): {mae_scaled:.3f}")
print(f"Scaled Model - Mean Squared Error (MSE): {mse_scaled:.3f}")
print(f"Scaled Model - Root Mean Squared Error (RMSE): {rmse_scaled:.3f}")
print(f"Scaled Model - R-squared (R2): {r2_scaled:.3f}")

plt.figure(figsize=(8, 6))
plt.scatter(y_test, y_pred_scaled, alpha=0.7)
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', label='Perfect Prediction')
plt.xlabel('Actual MPG')
plt.ylabel('Predicted MPG')
plt.title('Actual vs. Predicted MPG (Scaled Model)')
plt.legend()-=
plt.grid(True)
plt.show()